    {% extends 'base.html.twig' %}

    {% block title %}LACVI - Panier{% endblock %}

    {% block body %}

    {{ form_start(form, 
        {'attr': {'class': 'w-full flex-grow flex flex-col lg:grid lg:grid-cols-12 lg:items-start lg:gap-8 lg:px-16 lg:py-8'} }
    ) }}

        <!--Basket Section-->
        <section class="w-full h-full flex flex-col items-center gap-6 px-7 py-4 text-center lg:col-span-8 lg:items-end lg:gap-8 lg:px-12 lg:py-6 lg:border-r-2 lg:border-gray">
            <h2 class="w-full text-red text-center">Votre panier</h2>

            {% if order %}
            <!--Articles Section-->
            <div class="w-full flex-grow flex flex-col items-center gap-5">

                {% for key, article in articles %}
                <!--Article Card-->
                <div class="w-full flex justify-between items-center gap-4 py-5 border-t-2 border-gray lg:gap-5">
                    <a href="{{ path('article_remove', {'id': article.id}) }}">X</a>

                    <div class="w-2/5 aspect-square rounded-sm shadow-box lg:w-1/6">
                        <img src="{{ asset('img/placeholder.jpg') }}" alt="Article" class="w-full h-full object-cover rounded-sm" />
                    </div>

                    <div class="flex flex-grow flex-col items-center gap-2 py-4 lg:flex-row lg:gap-5 lg:justify-between">
                        <h4>{{ article.articleid.name }}</h4>

                        {% set price = article.articleid.price|default(0) %}
                        {% set quantity = article.quantity|default(0) %}

                        <p>{{ price|number_format(2, ',') }}€</p>

                        {{ form_widget(form.orderItems[key].quantity) }}

                        <h4>{{ (price * quantity)|number_format(2, ',') }}€</h4>
                    </div>
                </div>
                {% endfor %}

            </div>

            <a href="{{ path('basket_drop', {'id': order.id}) }}" class="w-auto h-auto px-6 py-3 rounded-sm bg-white border-2 border-red text-red shadow-box">Abandonner la commande</a>
            {% endif %}

            {% if not order %}
                <p class="w-full text-left">Vous n'avez rien dans votre panier.</p>
            {% endif %}
        </section>

        <!--Summary Section-->
        <section class="w-full flex flex-col items-center gap-6 px-8 py-5 text-left lg:col-span-4">

        {% if order %}
            <h3 class="w-full">Récapitulatif</h3>
            <h5 class="w-full">Pour le {{ order.date|format_datetime('medium', 'none', locale: 'fr') }}</h5>

            {{ form_widget(form.date) }}
            {{ form_errors(form.date) }}

            <div class="w-full flex flex-col gap-5 py-5 border-t-2 border-gray">

                {% set total = 0 %}

                {% for article in articles %}
                <!--Price Div-->
                <div class="w-full flex justify-between">
                    <p>{{ article.articleid.name }}</p>

                    {% set price = article.articleid.price|default(0) %}
                    {% set quantity = article.quantity|default(0) %}
                    {% set total = total + price * quantity %}

                    <p>{{ quantity }}</p>
                    <p>{{ (price * quantity)|number_format(2, ',') }}€</p>
                </div>
                {% endfor %}

                <div class="w-full flex justify-between py-4 border-t-2 border-dgray">
                    <p>Total</p>
                    <p>{{ total|number_format(2, ',') }}€</p>
                </div>
            </div>

            {{ form_widget(form.submit, {'attr': {'class': 'w-auto h-auto px-6 py-3 rounded-sm bg-white border-2 border-red text-red shadow-box'} }) }}
            <a href="{{ url('basket_validate', {'id': order.id}) }}" class="w-fit h-fit px-6 py-3 rounded-sm bg-red text-white shadow-box">Valider la commande</a>
            <a href="{{ url('search', {'id': 1}) }}" class="w-auto h-auto px-6 py-3 rounded-sm bg-white border-2 border-red text-red shadow-box">Continuer à commander</a>
        {% endif %}

        {% if not order %}
            <a href="{{ path('home') }}" class="w-fit h-fit px-6 py-3 rounded-sm bg-red text-white shadow-box">Retourner à l'accueil</a>
            <a href="{{ path('profile') }}" class="w-auto h-auto px-6 py-3 rounded-sm bg-white border-2 border-red text-red shadow-box">Voir le profil</a>
        {% endif %}

        </section>

    {{ form_end(form, {'render_rest': false}) }}

    {% endblock %}